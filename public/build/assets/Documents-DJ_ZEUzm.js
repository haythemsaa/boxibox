import{C as b}from"./ClientLayout-D-Q1RRq6.js";import{_ as h,r as y,f as D,o,w as _,a as e,d as m,g as c,c as r,i as u,n as f,t as i,h as x,l as F,F as k,j as S,x as g}from"./app-DscnimDf.js";/* empty css            */const w={components:{ClientLayout:b},props:{documents:{type:Object,required:!0},errors:{type:Object,default:()=>({})}},data(){return{selectedFile:null,isDragOver:!1,uploading:!1,form:{nom_document:""}}},methods:{handleDragEnter(s){this.isDragOver=!0},handleDragOver(s){this.isDragOver=!0},handleDragLeave(s){s.target===this.$refs.uploadZone&&(this.isDragOver=!1)},handleDrop(s){this.isDragOver=!1;const t=s.dataTransfer.files;t.length>0&&this.processFile(t[0])},handleFileSelect(s){const t=s.target.files;t.length>0&&this.processFile(t[0])},processFile(s){if(s.type!=="application/pdf"){alert("Seuls les fichiers PDF sont acceptés.");return}const t=20*1024*1024;if(s.size>t){alert("La taille du fichier ne doit pas dépasser 20 Mo.");return}this.selectedFile=s,this.form.nom_document||(this.form.nom_document=s.name.replace(".pdf",""))},removeFile(){this.selectedFile=null,this.$refs.fileInput.value=""},uploadDocument(){if(!this.selectedFile)return;this.uploading=!0;const s=new FormData;s.append("file",this.selectedFile),this.form.nom_document&&s.append("nom_document",this.form.nom_document),g.post(route("client.documents.upload"),s,{onSuccess:()=>{this.selectedFile=null,this.form.nom_document="",this.$refs.fileInput.value="",this.uploading=!1},onError:()=>{this.uploading=!1}})},confirmDelete(s){confirm("Êtes-vous sûr de vouloir supprimer ce document ?")&&g.delete(route("client.documents.delete",s.id))},changePage(s){s<1||s>this.documents.last_page||g.get(route("client.documents"),{page:s},{preserveState:!0,preserveScroll:!0})},formatDate(s){return s?new Date(s).toLocaleDateString("fr-FR"):""},formatTime(s){return s?new Date(s).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}):""},formatFileSize(s){if(!s)return"0 Octets";const t=1024,a=["Octets","Ko","Mo","Go"],p=Math.floor(Math.log(s)/Math.log(t));return Math.round(s/Math.pow(t,p)*100)/100+" "+a[p]},truncate(s,t){return s?s.length>t?s.substring(0,t)+"...":s:""}}},z={class:"card mb-4"},C={class:"card-body"},O={class:"upload-zone-content"},M={key:0,class:"text-danger mt-2"},L={class:"mb-3 mt-3"},E={key:0,class:"invalid-feedback"},T={key:1,class:"alert alert-info"},P={class:"d-flex align-items-center"},B={class:"flex-grow-1"},N={class:"text-muted"},j=["disabled"],I={key:0},V={key:1},A={class:"card"},q={class:"card-body p-0"},G={class:"table-responsive"},R={class:"table table-hover align-middle mb-0"},X={key:0},Z={key:1,class:"text-muted"},K={class:"text-muted"},U={key:0},H={key:1,class:"text-muted"},J={key:0,class:"badge bg-info"},Q={key:1,class:"badge bg-secondary"},W={class:"text-end"},Y={class:"btn-group btn-group-sm"},$=["href"],ee=["onClick"],te={key:0},se={key:0,class:"card-footer bg-white"},le={class:"d-flex justify-content-between align-items-center"},ne={class:"text-muted small"},ae={class:"pagination pagination-sm mb-0"};function oe(s,t,a,p,d,n){const v=y("ClientLayout");return o(),D(v,{title:"Mes Fichiers"},{default:_(()=>[t[31]||(t[31]=e("div",{class:"mb-4"},[e("h1",{class:"h3"},"Mes Fichiers"),e("p",{class:"text-muted"},"Consultez et téléchargez vos documents")],-1)),e("div",z,[t[20]||(t[20]=e("div",{class:"card-header bg-primary text-white"},[e("h5",{class:"mb-0"},[e("i",{class:"fas fa-cloud-upload-alt me-2"}),m("Envoyer un document")])],-1)),e("div",C,[e("form",{onSubmit:t[7]||(t[7]=c((...l)=>n.uploadDocument&&n.uploadDocument(...l),["prevent"])),enctype:"multipart/form-data"},[e("div",{ref:"uploadZone",class:f(["upload-zone",{dragover:d.isDragOver}]),onDragenter:t[1]||(t[1]=c((...l)=>n.handleDragEnter&&n.handleDragEnter(...l),["prevent"])),onDragover:t[2]||(t[2]=c((...l)=>n.handleDragOver&&n.handleDragOver(...l),["prevent"])),onDragleave:t[3]||(t[3]=c((...l)=>n.handleDragLeave&&n.handleDragLeave(...l),["prevent"])),onDrop:t[4]||(t[4]=c((...l)=>n.handleDrop&&n.handleDrop(...l),["prevent"]))},[e("div",O,[t[10]||(t[10]=e("i",{class:"fas fa-cloud-upload-alt fa-4x text-primary mb-3"},null,-1)),t[11]||(t[11]=e("h5",null,"Glissez-déposez votre fichier ici",-1)),t[12]||(t[12]=e("p",{class:"text-muted mb-3"},"ou",-1)),t[13]||(t[13]=e("label",{for:"document",class:"btn btn-primary"},[e("i",{class:"fas fa-folder-open me-1"}),m("Parcourir les fichiers ")],-1)),e("input",{type:"file",ref:"fileInput",class:"d-none",id:"document",accept:".pdf",onChange:t[0]||(t[0]=(...l)=>n.handleFileSelect&&n.handleFileSelect(...l))},null,544),t[14]||(t[14]=e("p",{class:"text-muted small mt-3 mb-0"},[e("i",{class:"fas fa-info-circle me-1"}),m(" Format accepté : PDF uniquement | Taille maximale : 20 Mo ")],-1))])],34),a.errors.document?(o(),r("div",M,i(a.errors.document),1)):u("",!0),e("div",L,[t[15]||(t[15]=e("label",{for:"nom_document",class:"form-label"},"Nom du document (optionnel)",-1)),x(e("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=l=>d.form.nom_document=l),class:f(["form-control",{"is-invalid":a.errors.nom_document}]),id:"nom_document",placeholder:"Laissez vide pour utiliser le nom du fichier"},null,2),[[F,d.form.nom_document]]),a.errors.nom_document?(o(),r("div",E,i(a.errors.nom_document),1)):u("",!0)]),d.selectedFile?(o(),r("div",T,[e("div",P,[t[18]||(t[18]=e("i",{class:"fas fa-file-pdf fa-2x text-danger me-3"},null,-1)),e("div",B,[e("strong",null,i(d.selectedFile.name),1),t[16]||(t[16]=e("br",null,null,-1)),e("small",N,i(n.formatFileSize(d.selectedFile.size)),1)]),e("button",{type:"button",class:"btn btn-sm btn-outline-danger",onClick:t[6]||(t[6]=(...l)=>n.removeFile&&n.removeFile(...l))},[...t[17]||(t[17]=[e("i",{class:"fas fa-times"},null,-1)])])])])):u("",!0),e("button",{type:"submit",class:"btn btn-primary",disabled:!d.selectedFile||d.uploading},[t[19]||(t[19]=e("i",{class:"fas fa-upload me-1"},null,-1)),d.uploading?(o(),r("span",I,"Envoi en cours...")):(o(),r("span",V,"Envoyer le document"))],8,j)],32)])]),e("div",A,[t[30]||(t[30]=e("div",{class:"card-header bg-white"},[e("h5",{class:"mb-0"},[e("i",{class:"fas fa-folder-open me-2"}),m("Mes Documents")])],-1)),e("div",q,[e("div",G,[e("table",R,[t[29]||(t[29]=e("thead",{class:"table-light"},[e("tr",null,[e("th",{style:{width:"50px"}},[e("i",{class:"fas fa-file"})]),e("th",null,"Nom du document"),e("th",null,"Type"),e("th",null,"Date d'ajout"),e("th",null,"Taille"),e("th",null,"Envoyé par"),e("th",{class:"text-end"},"Actions")])],-1)),e("tbody",null,[(o(!0),r(k,null,S(a.documents.data,l=>(o(),r("tr",{key:l.id},[t[26]||(t[26]=e("td",{class:"text-center"},[e("i",{class:"fas fa-file-pdf fa-2x text-danger"})],-1)),e("td",null,[e("strong",null,i(l.nom_document||l.nom_original),1),l.description?(o(),r("br",X)):u("",!0),l.description?(o(),r("small",Z,i(n.truncate(l.description,50)),1)):u("",!0)]),t[27]||(t[27]=e("td",null,[e("span",{class:"badge bg-danger"},"PDF")],-1)),e("td",null,[m(i(n.formatDate(l.created_at))+" ",1),t[21]||(t[21]=e("br",null,null,-1)),e("small",K,i(n.formatTime(l.created_at)),1)]),e("td",null,[l.taille?(o(),r("span",U,i(n.formatFileSize(l.taille)),1)):(o(),r("span",H,"N/A"))]),e("td",null,[l.uploaded_by===s.$page.props.auth?.user?.id?(o(),r("span",J,[...t[22]||(t[22]=[e("i",{class:"fas fa-user me-1"},null,-1),m("Vous ",-1)])])):(o(),r("span",Q,[...t[23]||(t[23]=[e("i",{class:"fas fa-building me-1"},null,-1),m("BOXIBOX ",-1)])]))]),e("td",W,[e("div",Y,[e("a",{href:s.route("client.documents.download",l.id),class:"btn btn-outline-primary",title:"Télécharger"},[...t[24]||(t[24]=[e("i",{class:"fas fa-download"},null,-1)])],8,$),l.uploaded_by===s.$page.props.auth?.user?.id?(o(),r("button",{key:0,type:"button",onClick:re=>n.confirmDelete(l),class:"btn btn-outline-danger",title:"Supprimer"},[...t[25]||(t[25]=[e("i",{class:"fas fa-trash"},null,-1)])],8,ee)):u("",!0)])])]))),128)),!a.documents.data||a.documents.data.length===0?(o(),r("tr",te,[...t[28]||(t[28]=[e("td",{colspan:"7",class:"text-center py-5"},[e("i",{class:"fas fa-folder-open fa-3x text-muted mb-3 d-block"}),e("p",{class:"text-muted mb-1"},"Aucun document"),e("small",{class:"text-muted"},"Envoyez votre premier document en utilisant le formulaire ci-dessus")],-1)])])):u("",!0)])])])]),a.documents.last_page>1?(o(),r("div",se,[e("div",le,[e("div",ne," Affichage de "+i(a.documents.from)+" à "+i(a.documents.to)+" sur "+i(a.documents.total)+" documents ",1),e("nav",null,[e("ul",ae,[e("li",{class:f(["page-item",{disabled:!a.documents.prev_page_url}])},[e("a",{class:"page-link",onClick:t[8]||(t[8]=c(l=>n.changePage(a.documents.current_page-1),["prevent"]))}," Précédent ")],2),e("li",{class:f(["page-item",{disabled:!a.documents.next_page_url}])},[e("a",{class:"page-link",onClick:t[9]||(t[9]=c(l=>n.changePage(a.documents.current_page+1),["prevent"]))}," Suivant ")],2)])])])])):u("",!0)])]),_:1})}const me=h(w,[["render",oe],["__scopeId","data-v-288bd0ec"]]);export{me as default};
