import{q as D,E as V,C as P,c,o as l,t as r,u as S,r as A,a as t,i as h,e as x,n as v,m as C,d as b,F as I,j as N,f as j,w as B,x as E}from"./app-BhQbKMjd.js";import{C as q}from"./ClientLayout-Dkl03K-0.js";import{_ as k}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{C as M,r as L}from"./chart-BRbCGdSi.js";/* empty css            */const T={props:{value:{type:[Number,String],required:!0},format:{type:String,default:"number"},duration:{type:Number,default:1e3}},setup(i){const e=D(a(0,i.format));let s=null;function a(n,f){const m=typeof n=="string"?parseFloat(n):n;switch(f){case"currency":return new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR",minimumFractionDigits:0,maximumFractionDigits:0}).format(m);case"percent":return`${m.toFixed(1)}%`;default:return new Intl.NumberFormat("fr-FR").format(m)}}function u(n,f,m){const p=Date.now(),o=f-n;function F(){const d=Date.now(),_=Math.min((d-p)/m,1),w=1-Math.pow(1-_,3),y=n+o*w;e.value=a(y,i.format),_<1&&(s=requestAnimationFrame(F))}F()}function g(n){s&&cancelAnimationFrame(s);const f=typeof e.value=="string"?parseFloat(e.value.replace(/[^\d.-]/g,"")):e.value,m=typeof n=="string"?parseFloat(n):n;u(f||0,m,i.duration)}return V(()=>i.value,n=>{g(n)}),P(()=>{g(i.value)}),{displayValue:e}}};function W(i,e,s,a,u,g){return l(),c("span",null,r(a.displayValue),1)}const z=k(T,[["render",W]]),Q={components:{AnimatedNumber:z},props:{label:{type:String,required:!0},value:{type:[Number,String],required:!0},icon:{type:String,required:!0},format:{type:String,default:"number"},gradient:{type:String,default:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},trend:{type:Number,default:null},showProgress:{type:Boolean,default:!1},progressValue:{type:Number,default:0},progressMax:{type:Number,default:100},progressColor:{type:String,default:"bg-primary"}},setup(i){const e=S(()=>i.trend===null?"":i.trend>0?"fa-arrow-up":"fa-arrow-down"),s=S(()=>i.trend===null?"":i.trend>0?"text-success":"text-danger"),a=S(()=>i.trend===null?"":`${Math.abs(i.trend)}% ${i.trend>0,"vs mois dernier"}`),u=S(()=>i.showProgress?Math.min(100,i.progressValue/i.progressMax*100):0);return{trendIcon:e,trendClass:s,trendText:a,progressPercentage:u}}},O={class:"stats-card card shadow-sm h-100"},U={class:"card-body"},H={class:"d-flex justify-content-between align-items-start"},Z={class:"flex-grow-1"},G={class:"stats-label text-muted mb-2"},J={class:"stats-value mb-2"},K={key:0,class:"stats-trend"},X={key:0,class:"card-footer bg-transparent border-0 pt-0"},Y={class:"progress",style:{height:"6px"}};function $(i,e,s,a,u,g){const n=A("AnimatedNumber");return l(),c("div",O,[t("div",U,[t("div",H,[t("div",Z,[t("div",G,r(s.label),1),t("div",J,[x(n,{value:s.value,format:s.format},null,8,["value","format"])]),s.trend!==null?(l(),c("div",K,[t("i",{class:v(["fas",a.trendIcon])},null,2),t("span",{class:v(a.trendClass)},r(a.trendText),3)])):h("",!0)]),t("div",{class:"stats-icon",style:C({background:s.gradient})},[t("i",{class:v(["fas",s.icon])},null,2)],4)])]),s.showProgress?(l(),c("div",X,[t("div",Y,[t("div",{class:v(["progress-bar",s.progressColor]),style:C({width:a.progressPercentage+"%"}),role:"progressbar"},null,6)])])):h("",!0)])}const tt=k(Q,[["render",$],["__scopeId","data-v-5910f887"]]),et={props:{actions:{type:Array,default:()=>[{id:1,title:"Payer mes factures",description:"Régler mes factures en attente",icon:"fa-credit-card",color:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",link:route("client.factures")},{id:2,title:"Mes codes d'accès",description:"Consulter mes codes PIN et QR",icon:"fa-qrcode",color:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",link:route("client.codes-acces")},{id:3,title:"Télécharger documents",description:"Contrats, factures PDF",icon:"fa-download",color:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",link:route("client.documents")},{id:4,title:"Mandat SEPA",description:"Configurer prélèvement auto",icon:"fa-university",color:"linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)",link:route("client.sepa")}]}}},st={class:"card shadow-sm h-100 quick-actions-widget"},at={class:"card-body p-0"},nt={class:"list-group list-group-flush"},it=["href"],ot={class:"flex-grow-1"},rt={class:"action-title"},lt={class:"text-muted"};function ct(i,e,s,a,u,g){return l(),c("div",st,[e[1]||(e[1]=t("div",{class:"card-header bg-white border-bottom"},[t("h6",{class:"mb-0"},[t("i",{class:"fas fa-bolt text-warning me-2"}),b(" Actions Rapides ")])],-1)),t("div",at,[t("div",nt,[(l(!0),c(I,null,N(s.actions,n=>(l(),c("a",{key:n.id,href:n.link,class:"list-group-item list-group-item-action d-flex align-items-center py-3"},[t("div",{class:"action-icon me-3",style:C({background:n.color})},[t("i",{class:v(["fas",n.icon])},null,2)],4),t("div",ot,[t("div",rt,r(n.title),1),t("small",lt,r(n.description),1)]),e[0]||(e[0]=t("i",{class:"fas fa-chevron-right text-muted"},null,-1))],8,it))),128))])])])}const dt=k(et,[["render",ct],["__scopeId","data-v-75f02640"]]),ut={props:{activities:{type:Array,default:()=>[]}},setup(){return{getActivityIcon:a=>({facture:"fa-file-invoice",paiement:"fa-credit-card",contrat:"fa-file-contract",document:"fa-file-alt",acces:"fa-key",profil:"fa-user",sepa:"fa-university",connexion:"fa-sign-in-alt"})[a]||"fa-circle",getActivityIconClass:a=>({facture:"bg-primary",paiement:"bg-success",contrat:"bg-info",document:"bg-secondary",acces:"bg-warning",profil:"bg-dark",sepa:"bg-success",connexion:"bg-primary"})[a]||"bg-secondary",formatRelativeTime:a=>{const u=new Date(a),n=new Date-u,f=Math.floor(n/6e4),m=Math.floor(n/36e5),p=Math.floor(n/864e5);return f<1?"À l'instant":f<60?`Il y a ${f} min`:m<24?`Il y a ${m}h`:p<7?`Il y a ${p}j`:u.toLocaleDateString("fr-FR")}}}},ft={class:"card shadow-sm h-100 activity-widget"},mt={class:"card-header bg-white border-bottom d-flex justify-content-between align-items-center"},bt=["href"],gt={class:"card-body p-0"},_t={key:0,class:"activity-timeline"},ht={class:"activity-content"},vt={class:"activity-title"},yt={class:"activity-description text-muted"},pt={class:"activity-time"},xt={key:1,class:"text-center py-5"};function wt(i,e,s,a,u,g){return l(),c("div",ft,[t("div",mt,[e[0]||(e[0]=t("h6",{class:"mb-0"},[t("i",{class:"fas fa-history me-2 text-info"}),b(" Activité Récente ")],-1)),t("a",{href:i.route("client.suivi"),class:"btn btn-sm btn-outline-primary"}," Tout voir ",8,bt)]),t("div",gt,[s.activities&&s.activities.length>0?(l(),c("div",_t,[(l(!0),c(I,null,N(s.activities.slice(0,5),(n,f)=>(l(),c("div",{key:n.id,class:v(["activity-item",{last:f===s.activities.slice(0,5).length-1}])},[t("div",{class:v(["activity-icon",a.getActivityIconClass(n.type)])},[t("i",{class:v(["fas",a.getActivityIcon(n.type)])},null,2)],2),t("div",ht,[t("div",vt,r(n.titre),1),t("div",yt,r(n.description),1),t("div",pt,[e[1]||(e[1]=t("i",{class:"far fa-clock me-1"},null,-1)),b(" "+r(a.formatRelativeTime(n.created_at)),1)])])],2))),128))])):(l(),c("div",xt,[...e[2]||(e[2]=[t("i",{class:"fas fa-history fa-3x text-muted mb-3"},null,-1),t("p",{class:"text-muted mb-0"},"Aucune activité récente",-1)])]))])])}const At=k(ut,[["render",wt],["__scopeId","data-v-0b812891"]]);M.register(...L);const Ct={components:{ClientLayout:q,StatsCard:tt,QuickActionsWidget:dt,RecentActivityWidget:At},props:{stats:{type:Object,default:()=>({})},contratsActifs:{type:Array,default:()=>[]},dernieresFactures:{type:Array,default:()=>[]},recentActivities:{type:Array,default:()=>[]}},setup(i){const e=D(null),s=D(null),a=D(!1),u=d=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(d||0),g=d=>d?new Date(d).toLocaleDateString("fr-FR"):"",n=d=>d?parseFloat(d).toFixed(2):"0.00",f=()=>{a.value=!0,E.reload({only:["stats","contratsActifs","dernieresFactures","recentActivities"],onFinish:()=>{a.value=!1}})},m=d=>({payee:"badge bg-success",paye:"badge bg-success",impayee:"badge bg-danger",en_attente:"badge bg-warning",en_retard:"badge bg-danger"})[d]||"badge bg-secondary",p=d=>({payee:"Payée",paye:"Payée",impayee:"Impayée",en_attente:"En attente",en_retard:"En retard"})[d]||d,o=()=>{window.dispatchEvent(new CustomEvent("open-chat"))},F=()=>{if(e.value){const d=i.stats.factures_payees||0,_=i.stats.factures_impayees||0,y=(i.stats.factures_total||d+_)-d-_;new M(e.value,{type:"doughnut",data:{labels:["Payées","Impayées","En attente"],datasets:[{data:[d,_,y],backgroundColor:["#28a745","#dc3545","#ffc107"],borderWidth:0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})}if(s.value){const d=new Date().getMonth(),_=[],w=[];for(let y=5;y>=0;y--){const R=new Date;R.setMonth(d-y),_.push(R.toLocaleDateString("fr-FR",{month:"short"})),w.push(Math.random()*1e3+500)}new M(s.value,{type:"line",data:{labels:_,datasets:[{label:"Montant payé (€)",data:w,backgroundColor:"rgba(13, 110, 253, 0.1)",borderColor:"#0d6efd",borderWidth:2,tension:.4,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,ticks:{callback:function(y){return y+" €"}}}}}})}};return P(()=>{F()}),{facturesChart:e,paymentsChart:s,refreshing:a,formatCurrency:u,formatDate:g,formatAmount:n,refreshStats:f,getStatusBadge:m,getStatusLabel:p,openChat:o}}},kt={class:"welcome-header mb-4"},Ft={class:"d-flex justify-content-between align-items-center flex-wrap"},St={class:"h2 mb-1"},Dt={class:"d-flex gap-2"},It=["disabled"],Nt=["href"],Mt={class:"row g-4 mb-4"},Rt={class:"col-xl-3 col-md-6"},Pt={class:"col-xl-3 col-md-6"},Vt={class:"col-xl-3 col-md-6"},jt={class:"col-xl-3 col-md-6"},Bt={key:0,class:"alert alert-warning alert-modern mb-4"},Et={class:"d-flex align-items-center"},qt={class:"flex-grow-1"},Lt={class:"mb-0"},Tt=["href"],Wt={key:1,class:"alert alert-info alert-modern mb-4"},zt={class:"d-flex align-items-center"},Qt=["href"],Ot={class:"row g-4 mb-4"},Ut={class:"col-xl-8"},Ht={class:"row g-4 mb-4"},Zt={class:"col-lg-6"},Gt={class:"card shadow-sm h-100"},Jt={class:"card-body"},Kt={ref:"facturesChart",height:"220"},Xt={class:"col-lg-6"},Yt={class:"card shadow-sm h-100"},$t={class:"card-body"},te={ref:"paymentsChart",height:"220"},ee={key:0,class:"card shadow-sm mb-4"},se={class:"card-header bg-white border-bottom d-flex justify-content-between align-items-center"},ae=["href"],ne={class:"card-body p-0"},ie={class:"table-responsive"},oe={class:"table table-hover mb-0"},re={class:"text-primary"},le={key:0},ce={class:"text-success"},de=["href"],ue={key:1,class:"card shadow-sm"},fe={class:"card-header bg-white border-bottom d-flex justify-content-between align-items-center"},me=["href"],be={class:"card-body p-0"},ge={class:"table-responsive"},_e={class:"table table-hover mb-0"},he=["href"],ve={class:"col-xl-4"},ye={class:"mb-4"},pe={class:"mb-4"},xe={key:0,class:"card shadow-sm mb-4"},we={class:"card-body"},Ae={key:0,class:"box-info"},Ce={class:"text-center mb-3"},ke={class:"box-number"},Fe={class:"box-details"},Se={class:"d-flex justify-content-between mb-2"},De={class:"d-flex justify-content-between mb-2"},Ie={class:"d-flex justify-content-between mb-3"},Ne=["href"],Me={class:"card shadow-sm support-card"},Re={class:"card-body text-center p-4"};function Pe(i,e,s,a,u,g){const n=A("StatsCard"),f=A("QuickActionsWidget"),m=A("RecentActivityWidget"),p=A("ClientLayout");return l(),j(p,{title:"Tableau de bord"},{default:B(()=>[t("div",kt,[t("div",Ft,[t("div",null,[t("h1",St," Bonjour "+r(i.$page.props.auth.user?.name||"Client")+" 👋 ",1),e[2]||(e[2]=t("p",{class:"text-muted mb-0"}," Voici un aperçu de votre espace de stockage ",-1))]),t("div",Dt,[t("button",{onClick:e[0]||(e[0]=(...o)=>a.refreshStats&&a.refreshStats(...o)),class:"btn btn-outline-primary",disabled:a.refreshing},[t("i",{class:v(["fas fa-sync-alt me-2",{"fa-spin":a.refreshing}])},null,2),e[3]||(e[3]=b(" Actualiser ",-1))],8,It),t("a",{href:i.route("client.contrats"),class:"btn btn-primary"},[...e[4]||(e[4]=[t("i",{class:"fas fa-plus me-2"},null,-1),b(" Nouveau contrat ",-1)])],8,Nt)])])]),t("div",Mt,[t("div",Rt,[x(n,{label:"Contrats Actifs",value:s.stats.contrats_actifs||0,icon:"fa-file-contract",gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",format:"number",trend:5},null,8,["value"])]),t("div",Pt,[x(n,{label:"Factures Impayées",value:s.stats.factures_impayees||0,icon:"fa-exclamation-triangle",gradient:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",format:"number",trend:-10},null,8,["value"])]),t("div",Vt,[x(n,{label:"Montant Dû",value:s.stats.montant_du||0,icon:"fa-euro-sign",gradient:"linear-gradient(135deg, #fa709a 0%, #fee140 100%)",format:"currency"},null,8,["value"])]),t("div",jt,[x(n,{label:"Prélèvement Auto",value:s.stats.mandat_sepa_actif?"Actif":"Inactif",icon:"fa-check-circle",gradient:s.stats.mandat_sepa_actif?"linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)":"linear-gradient(135deg, #9795f0 0%, #fbc8d4 100%)",format:"text"},null,8,["value","gradient"])])]),s.stats.factures_impayees>0?(l(),c("div",Bt,[t("div",Et,[e[6]||(e[6]=t("div",{class:"alert-icon"},[t("i",{class:"fas fa-exclamation-triangle"})],-1)),t("div",qt,[e[5]||(e[5]=t("h6",{class:"alert-heading mb-1"},"Factures en attente",-1)),t("p",Lt," Vous avez "+r(s.stats.factures_impayees)+" facture(s) impayée(s) pour un montant de "+r(a.formatCurrency(s.stats.montant_du))+". ",1)]),t("a",{href:i.route("client.factures"),class:"btn btn-warning"}," Payer maintenant ",8,Tt)])])):h("",!0),s.stats.mandat_sepa_actif?h("",!0):(l(),c("div",Wt,[t("div",zt,[e[7]||(e[7]=t("div",{class:"alert-icon bg-info"},[t("i",{class:"fas fa-university"})],-1)),e[8]||(e[8]=t("div",{class:"flex-grow-1"},[t("h6",{class:"alert-heading mb-1"},"Simplifiez vos paiements"),t("p",{class:"mb-0"}," Activez le prélèvement automatique SEPA et ne vous souciez plus de vos échéances. ")],-1)),t("a",{href:i.route("client.sepa.create"),class:"btn btn-info"}," Configurer ",8,Qt)])])),t("div",Ot,[t("div",Ut,[t("div",Ht,[t("div",Zt,[t("div",Gt,[e[9]||(e[9]=t("div",{class:"card-header bg-white border-bottom"},[t("h6",{class:"mb-0"},[t("i",{class:"fas fa-chart-pie me-2 text-primary"}),b(" Répartition des Factures ")])],-1)),t("div",Jt,[t("canvas",Kt,null,512)])])]),t("div",Xt,[t("div",Yt,[e[10]||(e[10]=t("div",{class:"card-header bg-white border-bottom"},[t("h6",{class:"mb-0"},[t("i",{class:"fas fa-chart-line me-2 text-success"}),b(" Paiements (6 mois) ")])],-1)),t("div",$t,[t("canvas",te,null,512)])])])]),s.contratsActifs&&s.contratsActifs.length>0?(l(),c("div",ee,[t("div",se,[e[11]||(e[11]=t("h6",{class:"mb-0"},[t("i",{class:"fas fa-file-contract me-2 text-primary"}),b(" Mes Contrats Actifs ")],-1)),t("a",{href:i.route("client.contrats"),class:"btn btn-sm btn-outline-primary"}," Voir tout ",8,ae)]),t("div",ne,[t("div",ie,[t("table",oe,[e[14]||(e[14]=t("thead",{class:"table-light"},[t("tr",null,[t("th",null,"N° Contrat"),t("th",null,"Box"),t("th",null,"Date Début"),t("th",null,"Loyer"),t("th",null,"Actions")])],-1)),t("tbody",null,[(l(!0),c(I,null,N(s.contratsActifs.slice(0,3),o=>(l(),c("tr",{key:o.id},[t("td",null,[t("strong",re,r(o.numero_contrat),1)]),t("td",null,[o.box?(l(),c("span",le,[e[12]||(e[12]=t("i",{class:"fas fa-box me-1"},null,-1)),b(" Box "+r(o.box.numero)+" ",1),o.box.famille?(l(),c("span",{key:0,class:"badge ms-1",style:C({backgroundColor:o.box.famille.couleur||"#6c757d"})},r(o.box.famille.nom),5)):h("",!0)])):h("",!0)]),t("td",null,r(a.formatDate(o.date_debut)),1),t("td",null,[t("strong",ce,r(a.formatAmount(o.montant_loyer))+" €/mois",1)]),t("td",null,[t("a",{href:i.route("client.contrats.show",o.id),class:"btn btn-sm btn-outline-primary"},[...e[13]||(e[13]=[t("i",{class:"fas fa-eye"},null,-1)])],8,de)])]))),128))])])])])])):h("",!0),s.dernieresFactures&&s.dernieresFactures.length>0?(l(),c("div",ue,[t("div",fe,[e[15]||(e[15]=t("h6",{class:"mb-0"},[t("i",{class:"fas fa-file-invoice me-2 text-warning"}),b(" Dernières Factures ")],-1)),t("a",{href:i.route("client.factures"),class:"btn btn-sm btn-outline-primary"}," Voir tout ",8,me)]),t("div",be,[t("div",ge,[t("table",_e,[e[17]||(e[17]=t("thead",{class:"table-light"},[t("tr",null,[t("th",null,"N° Facture"),t("th",null,"Date"),t("th",null,"Échéance"),t("th",null,"Montant"),t("th",null,"Statut"),t("th",null,"Actions")])],-1)),t("tbody",null,[(l(!0),c(I,null,N(s.dernieresFactures.slice(0,3),o=>(l(),c("tr",{key:o.id},[t("td",null,[t("strong",null,r(o.numero_facture),1)]),t("td",null,r(a.formatDate(o.date_emission)),1),t("td",null,r(a.formatDate(o.date_echeance)),1),t("td",null,[t("strong",null,r(a.formatAmount(o.montant_ttc))+" €",1)]),t("td",null,[t("span",{class:v(a.getStatusBadge(o.statut))},r(a.getStatusLabel(o.statut)),3)]),t("td",null,[t("a",{href:i.route("client.factures.show",o.id),class:"btn btn-sm btn-outline-primary"},[...e[16]||(e[16]=[t("i",{class:"fas fa-eye"},null,-1)])],8,he)])]))),128))])])])])])):h("",!0)]),t("div",ve,[t("div",ye,[x(f)]),t("div",pe,[x(m,{activities:s.recentActivities},null,8,["activities"])]),s.contratsActifs&&s.contratsActifs.length>0?(l(),c("div",xe,[e[22]||(e[22]=t("div",{class:"card-header bg-white border-bottom"},[t("h6",{class:"mb-0"},[t("i",{class:"fas fa-box me-2 text-info"}),b(" Ma Box Principale ")])],-1)),t("div",we,[s.contratsActifs[0].box?(l(),c("div",Ae,[t("div",Ce,[t("div",ke,r(s.contratsActifs[0].box.numero),1),s.contratsActifs[0].box.famille?(l(),c("span",{key:0,class:"badge",style:C({backgroundColor:s.contratsActifs[0].box.famille.couleur||"#6c757d"})},r(s.contratsActifs[0].box.famille.nom),5)):h("",!0)]),t("div",Fe,[t("div",Se,[e[18]||(e[18]=t("span",{class:"text-muted"},"Dimensions:",-1)),t("strong",null,r(s.contratsActifs[0].box.largeur)+"m × "+r(s.contratsActifs[0].box.profondeur)+"m",1)]),t("div",De,[e[19]||(e[19]=t("span",{class:"text-muted"},"Surface:",-1)),t("strong",null,r(s.contratsActifs[0].box.surface)+" m²",1)]),t("div",Ie,[e[20]||(e[20]=t("span",{class:"text-muted"},"Étage:",-1)),t("strong",null,r(s.contratsActifs[0].box.etage||"RDC"),1)]),t("a",{href:i.route("client.boxplan"),class:"btn btn-outline-primary btn-sm w-100"},[...e[21]||(e[21]=[t("i",{class:"fas fa-map-marked-alt me-2"},null,-1),b(" Voir le plan ",-1)])],8,Ne)])])):h("",!0)])])):h("",!0),t("div",Me,[t("div",Re,[e[24]||(e[24]=t("div",{class:"support-icon mb-3"},[t("i",{class:"fas fa-headset"})],-1)),e[25]||(e[25]=t("h6",{class:"mb-2"},"Besoin d'aide ?",-1)),e[26]||(e[26]=t("p",{class:"text-muted small mb-3"}," Notre équipe est là pour vous aider ",-1)),t("button",{onClick:e[1]||(e[1]=(...o)=>a.openChat&&a.openChat(...o)),class:"btn btn-primary w-100 mb-2"},[...e[23]||(e[23]=[t("i",{class:"fas fa-comments me-2"},null,-1),b(" Ouvrir le chat ",-1)])]),e[27]||(e[27]=t("a",{href:"tel:+33123456789",class:"btn btn-outline-primary w-100"},[t("i",{class:"fas fa-phone me-2"}),b(" 01 23 45 67 89 ")],-1))])])])])]),_:1})}const Le=k(Ct,[["render",Pe],["__scopeId","data-v-8ff99e9b"]]);export{Le as default};
