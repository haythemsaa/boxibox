import{_ as g,r as u,f as h,o as _,w as m,a as e,d as r,g as C,h as f,l as x,v as k,t as D,e as S,s as F,x as i}from"./app-CRj_m259.js";import{C as T}from"./ClientLayout-C9U263p5.js";import{E as P}from"./EditableTable-N89an40o.js";/* empty css            */const N={components:{ClientLayout:T,EditableTable:P},props:{contrats:{type:[Object,Array],required:!0},queryParams:{type:Object,default:()=>({})}},setup(o){const t=F({search:o.queryParams.search||"",statut:o.queryParams.statut||""}),n=[{key:"numero_contrat",label:"N° Contrat",type:"text",format:s=>`<strong>${s}</strong>`},{key:"client_nom",label:"Client",type:"text",format:(s,l)=>l.client?`${l.client.prenom} ${l.client.nom}`:"-"},{key:"box_numero",label:"Box",type:"text",format:(s,l)=>{if(l.box){const y=l.box.famille?.couleur||"#6c757d",v=l.box.famille?.nom||"";return`Box ${l.box.numero} <span class="badge ms-1" style="background-color: ${y}">${v}</span>`}return"-"}},{key:"date_debut",label:"Date Début",type:"date"},{key:"date_fin",label:"Date Fin",type:"date"},{key:"montant_loyer",label:"Loyer Mensuel",type:"currency",cellClass:"text-end"},{key:"statut",label:"Statut",type:"select",options:[{value:"actif",label:"Actif"},{value:"resilie",label:"Résilié"},{value:"termine",label:"Terminé"}],badges:{actif:{class:"bg-success",label:"Actif"},resilie:{class:"bg-danger",label:"Résilié"},termine:{class:"bg-secondary",label:"Terminé"}}}],a=()=>{i.get(route("contrats.index"),t,{preserveState:!0,preserveScroll:!0})};return{filters:t,columns:n,applyFilters:a,resetFilters:()=>{t.search="",t.statut="",a()},handleUpdate:({id:s,data:l})=>{i.put(route("contrats.update",s),l,{preserveScroll:!0,onSuccess:()=>{}})},handleDelete:s=>{confirm(`Êtes-vous sûr de vouloir supprimer le contrat ${s.numero_contrat} ?`)&&i.delete(route("contrats.destroy",s.id),{preserveScroll:!0})},handlePageChange:s=>{i.get(route("contrats.index"),{...t,page:s},{preserveState:!0,preserveScroll:!0})}}}},U={class:"mb-4"},V={class:"d-flex justify-content-between align-items-center"},A=["href"],B={class:"card mb-4"},L={class:"card-body"},M={class:"col-md-3"},R={class:"col-md-2"},q={class:"col-md-2"},E={class:"card"},j={class:"card-header"},w={class:"mb-0"},G={class:"card-body"},O=["href"],I=["href"];function z(o,t,n,a,b,p){const c=u("EditableTable"),d=u("ClientLayout");return _(),h(d,{title:"Gestion des Contrats"},{default:m(()=>[e("div",U,[e("div",V,[t[5]||(t[5]=e("h1",{class:"h3"},[e("i",{class:"fas fa-file-contract me-2"}),r(" Gestion des Contrats ")],-1)),e("a",{href:o.route("contrats.create"),class:"btn btn-primary"},[...t[4]||(t[4]=[e("i",{class:"fas fa-plus me-2"},null,-1),r(" Nouveau Contrat ",-1)])],8,A)])]),e("div",B,[e("div",L,[e("form",{onSubmit:t[3]||(t[3]=C((...s)=>a.applyFilters&&a.applyFilters(...s),["prevent"])),class:"row g-3"},[e("div",M,[f(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>a.filters.search=s),class:"form-control",placeholder:"Rechercher N° contrat ou client..."},null,512),[[x,a.filters.search]])]),e("div",R,[f(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>a.filters.statut=s),class:"form-select"},[...t[6]||(t[6]=[e("option",{value:""},"Tous les statuts",-1),e("option",{value:"actif"},"Actif",-1),e("option",{value:"resilie"},"Résilié",-1),e("option",{value:"termine"},"Terminé",-1)])],512),[[k,a.filters.statut]])]),t[8]||(t[8]=e("div",{class:"col-md-2"},[e("button",{type:"submit",class:"btn btn-primary w-100"},[e("i",{class:"fas fa-filter me-1"}),r("Filtrer ")])],-1)),e("div",q,[e("button",{type:"button",onClick:t[2]||(t[2]=(...s)=>a.resetFilters&&a.resetFilters(...s)),class:"btn btn-secondary w-100"},[...t[7]||(t[7]=[e("i",{class:"fas fa-redo me-1"},null,-1),r("Réinitialiser ",-1)])])])],32)])]),e("div",E,[e("div",j,[e("h5",w,"Liste des Contrats ("+D(n.contrats.total||n.contrats.length)+")",1)]),e("div",G,[S(c,{data:n.contrats.data||n.contrats,columns:a.columns,editable:!0,deletable:!0,pagination:n.contrats.meta||null,"update-route":o.route("contrats.update",":id"),"empty-message":"Aucun contrat trouvé",onUpdate:a.handleUpdate,onDelete:a.handleDelete,onPageChange:a.handlePageChange},{"row-actions":m(({row:s})=>[e("a",{href:o.route("contrats.show",s.id),class:"btn btn-sm btn-outline-info",title:"Voir détails"},[...t[9]||(t[9]=[e("i",{class:"fas fa-eye"},null,-1)])],8,O),e("a",{href:o.route("contrats.pdf",s.id),class:"btn btn-sm btn-outline-secondary",title:"Télécharger PDF",target:"_blank"},[...t[10]||(t[10]=[e("i",{class:"fas fa-file-pdf"},null,-1)])],8,I)]),_:1},8,["data","columns","pagination","update-route","onUpdate","onDelete","onPageChange"])])])]),_:1})}const W=g(N,[["render",z],["__scopeId","data-v-72c85826"]]);export{W as default};
