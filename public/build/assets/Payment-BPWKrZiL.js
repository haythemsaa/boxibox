import{O as p,r as f,f as v,o as l,w as c,a as e,e as b,d as a,t as o,n as u,c as d,i as _}from"./app-zGlaTtug.js";import{C as h,u as w}from"./ClientLayout-DE-sKSWk.js";import{_ as x}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css            */const k={components:{ClientLayout:h,Link:p},props:{facture:{type:Object,required:!0},stripePublicKey:{type:String,required:!0}},setup(){return{toast:w()}},data(){return{isProcessing:!1}},computed:{isOverdue(){const t=new Date;return new Date(this.facture.date_echeance)<t&&this.facture.statut!=="payee"}},methods:{async proceedToPayment(){this.isProcessing=!0;try{const t=await axios.post(route("client.payment.checkout",this.facture.id));if(t.data.url)window.location.href=t.data.url;else throw new Error("URL de paiement invalide")}catch(t){this.isProcessing=!1,console.error("Erreur paiement:",t);const s=t.response?.data?.error||"Une erreur est survenue lors de la création de la session de paiement";this.toast.error(s)}},formatDate(t){return t?new Date(t).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"}):"-"},formatCurrency(t){return new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(t)},getStatusLabel(t){return{brouillon:"Brouillon",envoyee:"Envoyée",payee:"Payée",en_attente:"En attente",en_retard:"En retard",annulee:"Annulée"}[t]||t},getBadgeClass(t){return{brouillon:"bg-secondary",envoyee:"bg-info",payee:"bg-success",en_attente:"bg-warning",en_retard:"bg-danger",annulee:"bg-dark"}[t]||"bg-secondary"}}},P={class:"container py-4"},C={class:"row justify-content-center"},D={class:"col-lg-8"},L={class:"d-flex align-items-center mb-4"},S={class:"card shadow-sm mb-4"},E={class:"card-header bg-primary text-white"},T={class:"mb-0"},B={class:"card-body"},V={class:"row mb-3"},A={class:"col-md-6"},N={class:"mb-2"},R={class:"mb-2"},j={class:"col-md-6"},q={key:0,class:"mb-2"},F={class:"mb-2"},M={class:"d-flex justify-content-between align-items-center"},O={class:"mb-0 text-primary"},U={class:"text-muted small mt-2 mb-0"},z={class:"d-grid gap-2"},I=["disabled"],K={key:0},G={key:1};function H(t,s,n,J,i,r){const m=f("Link"),y=f("ClientLayout");return l(),v(y,null,{default:c(()=>[e("div",P,[e("div",C,[e("div",D,[e("div",L,[b(m,{href:t.route("client.factures.show",n.facture.id),class:"btn btn-outline-secondary me-3"},{default:c(()=>[...s[1]||(s[1]=[e("i",{class:"fas fa-arrow-left"},null,-1)])]),_:1},8,["href"]),s[2]||(s[2]=e("div",null,[e("h2",{class:"mb-0"},"Paiement en ligne"),e("p",{class:"text-muted mb-0"},"Paiement sécurisé via Stripe")],-1))]),e("div",S,[e("div",E,[e("h5",T,[s[3]||(s[3]=e("i",{class:"fas fa-file-invoice me-2"},null,-1)),a(" Facture "+o(n.facture.numero_facture),1)])]),e("div",B,[e("div",V,[e("div",A,[e("p",N,[s[4]||(s[4]=e("strong",null,"Date d'émission :",-1)),s[5]||(s[5]=e("br",null,null,-1)),a(" "+o(r.formatDate(n.facture.date_emission)),1)]),e("p",R,[s[6]||(s[6]=e("strong",null,"Date d'échéance :",-1)),s[7]||(s[7]=e("br",null,null,-1)),e("span",{class:u({"text-danger fw-bold":r.isOverdue})},o(r.formatDate(n.facture.date_echeance)),3)])]),e("div",j,[n.facture.contrat?(l(),d("p",q,[s[8]||(s[8]=e("strong",null,"Contrat :",-1)),s[9]||(s[9]=e("br",null,null,-1)),a(" "+o(n.facture.contrat.numero_contrat),1)])):_("",!0),e("p",F,[s[10]||(s[10]=e("strong",null,"Statut :",-1)),s[11]||(s[11]=e("br",null,null,-1)),e("span",{class:u(["badge",r.getBadgeClass(n.facture.statut)])},o(r.getStatusLabel(n.facture.statut)),3)])])]),s[14]||(s[14]=e("hr",null,null,-1)),e("div",M,[s[12]||(s[12]=e("h5",{class:"mb-0"},"Montant à payer",-1)),e("h3",O,o(r.formatCurrency(n.facture.montant_ttc)),1)]),e("p",U,[s[13]||(s[13]=e("i",{class:"fas fa-info-circle me-1"},null,-1)),a(" Montant TTC incluant "+o(n.facture.taux_tva)+"% de TVA ",1)])])]),s[18]||(s[18]=e("div",{class:"card shadow-sm mb-4"},[e("div",{class:"card-body"},[e("h5",{class:"mb-3"},[e("i",{class:"fas fa-shield-alt text-success me-2"}),a(" Paiement sécurisé ")]),e("ul",{class:"list-unstyled"},[e("li",{class:"mb-2"},[e("i",{class:"fas fa-check text-success me-2"}),a(" Vos informations bancaires sont cryptées et sécurisées ")]),e("li",{class:"mb-2"},[e("i",{class:"fas fa-check text-success me-2"}),a(" Paiement traité par Stripe, leader mondial du paiement en ligne ")]),e("li",{class:"mb-2"},[e("i",{class:"fas fa-check text-success me-2"}),a(" Aucune donnée bancaire n'est stockée sur nos serveurs ")]),e("li",{class:"mb-2"},[e("i",{class:"fas fa-check text-success me-2"}),a(" Confirmation immédiate par email ")])]),e("div",{class:"alert alert-info mt-3"},[e("i",{class:"fas fa-credit-card me-2"}),e("strong",null,"Modes de paiement acceptés :"),a(" Visa, Mastercard, American Express ")])])],-1)),e("div",z,[e("button",{onClick:s[0]||(s[0]=(...g)=>r.proceedToPayment&&r.proceedToPayment(...g)),class:"btn btn-primary btn-lg",disabled:i.isProcessing},[i.isProcessing?(l(),d("span",G,[...s[16]||(s[16]=[e("span",{class:"spinner-border spinner-border-sm me-2"},null,-1),a(" Redirection vers Stripe... ",-1)])])):(l(),d("span",K,[...s[15]||(s[15]=[e("i",{class:"fas fa-lock me-2"},null,-1),a(" Procéder au paiement sécurisé ",-1)])]))],8,I),b(m,{href:t.route("client.factures.show",n.facture.id),class:u(["btn btn-outline-secondary",{disabled:i.isProcessing}])},{default:c(()=>[...s[17]||(s[17]=[a(" Annuler ",-1)])]),_:1},8,["href","class"])]),s[19]||(s[19]=e("p",{class:"text-muted text-center mt-4 small"},[a(' En cliquant sur "Procéder au paiement", vous serez redirigé vers la page de paiement sécurisée Stripe. '),e("br"),a(" Une fois le paiement effectué, votre facture sera automatiquement mise à jour. ")],-1))])])])]),_:1})}const Z=x(k,[["render",H],["__scopeId","data-v-c6701b7a"]]);export{Z as default};
