import{r as D,f as F,o as i,w as S,a as t,c as d,i as f,d as c,t as n,n as p,F as x,j as w,m as B,q as C,C as L,x as M}from"./app-BhQbKMjd.js";import{C as E}from"./ClientLayout-Dkl03K-0.js";import{C as _,r as N}from"./chart-BRbCGdSi.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css            */_.register(...N);const V={components:{ClientLayout:E},props:{stats:{type:Object,default:()=>({})},contratsActifs:{type:Array,default:()=>[]},dernieresFactures:{type:Array,default:()=>[]}},setup(r){const s=C(null),a=C(null),l=o=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(o||0),y=o=>o?new Date(o).toLocaleDateString("fr-FR"):"",g=o=>o?parseFloat(o).toFixed(2):"0.00",b=()=>{M.reload({only:["stats"]})},e=o=>({payee:"badge bg-success",paye:"badge bg-success",impayee:"badge bg-danger",en_attente:"badge bg-warning",en_retard:"badge bg-danger"})[o]||"badge bg-secondary",A=o=>({payee:"Payée",paye:"Payée",impayee:"Impayée",en_attente:"En attente",en_retard:"En retard"})[o]||o,k=()=>{if(s.value){const o=r.stats.factures_payees||0,u=r.stats.factures_impayees||0,m=(r.stats.factures_total||o+u)-o-u;new _(s.value,{type:"doughnut",data:{labels:["Payées","Impayées","En attente"],datasets:[{data:[o,u,m],backgroundColor:["#28a745","#dc3545","#ffc107"],borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})}if(a.value){const o=new Date().getMonth(),u=[],h=[];for(let m=5;m>=0;m--){const v=new Date;v.setMonth(o-m),u.push(v.toLocaleDateString("fr-FR",{month:"short",year:"numeric"})),h.push(Math.random()*1e3+500)}new _(a.value,{type:"bar",data:{labels:u,datasets:[{label:"Montant payé (€)",data:h,backgroundColor:"#0d6efd",borderColor:"#0d6efd",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,ticks:{callback:function(m){return m+" €"}}}}}})}};return L(()=>{k()}),{facturesChart:s,paymentsChart:a,formatCurrency:l,formatDate:y,formatAmount:g,refreshStats:b,getStatusBadge:e,getStatusLabel:A}}},P={class:"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3"},z={class:"h3"},I={class:"row mb-4"},T={class:"col-xl-3 col-md-6 mb-3"},j={class:"card border-left-primary shadow h-100 py-2"},q={class:"card-body"},O={class:"row no-gutters align-items-center"},W={class:"col mr-2"},U={class:"h5 mb-0 font-weight-bold text-gray-800"},Z={class:"col-xl-3 col-md-6 mb-3"},G={class:"card border-left-warning shadow h-100 py-2"},H={class:"card-body"},J={class:"row no-gutters align-items-center"},K={class:"col mr-2"},Q={class:"h5 mb-0 font-weight-bold text-gray-800"},X={class:"col-xl-3 col-md-6 mb-3"},Y={class:"card border-left-danger shadow h-100 py-2"},$={class:"card-body"},tt={class:"row no-gutters align-items-center"},st={class:"col mr-2"},et={class:"h5 mb-0 font-weight-bold text-gray-800"},at={class:"col-xl-3 col-md-6 mb-3"},ot={class:"card border-left-success shadow h-100 py-2"},nt={class:"card-body"},lt={class:"row no-gutters align-items-center"},rt={class:"col mr-2"},it={class:"h5 mb-0 font-weight-bold text-gray-800"},dt={class:"col-auto"},ct={key:0,class:"alert alert-warning alert-dismissible fade show",role:"alert"},ut=["href"],mt={key:1,class:"alert alert-info alert-dismissible fade show",role:"alert"},ft=["href"],bt={class:"row mb-4"},ht={class:"col-xl-6 col-lg-6 mb-4"},_t={class:"card shadow"},yt={class:"card-body"},gt={ref:"facturesChart",height:"200"},vt={class:"col-xl-6 col-lg-6 mb-4"},pt={class:"card shadow"},xt={class:"card-body"},wt={ref:"paymentsChart",height:"200"},Ct={key:2,class:"card shadow mb-4"},At={class:"card-body"},kt={class:"table-responsive"},Dt={class:"table table-hover"},Ft={key:0},St={class:"text-primary"},Bt=["href"],Lt={class:"text-center mt-3"},Mt=["href"],Et={key:3,class:"card shadow mb-4"},Nt={class:"card-body"},Rt={class:"table-responsive"},Vt={class:"table table-hover"},Pt={class:"text-end"},zt=["href"],It={class:"text-center mt-3"},Tt=["href"];function jt(r,s,a,l,y,g){const b=D("ClientLayout");return i(),F(b,{title:"Tableau de bord"},{default:S(()=>[t("div",P,[t("h1",z,[s[1]||(s[1]=t("i",{class:"fas fa-home me-2"},null,-1)),c(" Bienvenue"+n(r.$page.props.auth.user?", "+r.$page.props.auth.user.name:""),1)]),t("button",{type:"button",class:"btn btn-sm btn-outline-secondary",onClick:s[0]||(s[0]=(...e)=>l.refreshStats&&l.refreshStats(...e))},[...s[2]||(s[2]=[t("i",{class:"fas fa-sync-alt me-1"},null,-1),c(" Actualiser ",-1)])])]),t("div",I,[t("div",T,[t("div",j,[t("div",q,[t("div",O,[t("div",W,[s[3]||(s[3]=t("div",{class:"text-xs font-weight-bold text-primary text-uppercase mb-1"}," Contrats Actifs ",-1)),t("div",U,n(a.stats.contrats_actifs||0),1)]),s[4]||(s[4]=t("div",{class:"col-auto"},[t("i",{class:"fas fa-file-contract fa-2x text-gray-300"})],-1))])])])]),t("div",Z,[t("div",G,[t("div",H,[t("div",J,[t("div",K,[s[5]||(s[5]=t("div",{class:"text-xs font-weight-bold text-warning text-uppercase mb-1"}," Factures Impayées ",-1)),t("div",Q,n(a.stats.factures_impayees||0),1)]),s[6]||(s[6]=t("div",{class:"col-auto"},[t("i",{class:"fas fa-exclamation-triangle fa-2x text-gray-300"})],-1))])])])]),t("div",X,[t("div",Y,[t("div",$,[t("div",tt,[t("div",st,[s[7]||(s[7]=t("div",{class:"text-xs font-weight-bold text-danger text-uppercase mb-1"}," Montant Dû ",-1)),t("div",et,n(l.formatCurrency(a.stats.montant_du)),1)]),s[8]||(s[8]=t("div",{class:"col-auto"},[t("i",{class:"fas fa-euro-sign fa-2x text-gray-300"})],-1))])])])]),t("div",at,[t("div",ot,[t("div",nt,[t("div",lt,[t("div",rt,[s[9]||(s[9]=t("div",{class:"text-xs font-weight-bold text-success text-uppercase mb-1"}," SEPA Actif ",-1)),t("div",it,n(a.stats.mandat_sepa_actif?"Oui":"Non"),1)]),t("div",dt,[t("i",{class:p(["fas fa-check-circle fa-2x",a.stats.mandat_sepa_actif?"text-success":"text-gray-300"])},null,2)])])])])])]),a.stats.factures_impayees>0?(i(),d("div",ct,[s[10]||(s[10]=t("i",{class:"fas fa-exclamation-triangle me-2"},null,-1)),s[11]||(s[11]=t("strong",null,"Attention !",-1)),c(" Vous avez "+n(a.stats.factures_impayees)+" facture(s) impayée(s) pour un montant de "+n(l.formatCurrency(a.stats.montant_du))+". ",1),t("a",{href:r.route("client.factures"),class:"alert-link"},"Voir les factures",8,ut),s[12]||(s[12]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert"},null,-1))])):f("",!0),a.stats.mandat_sepa_actif?f("",!0):(i(),d("div",mt,[s[13]||(s[13]=t("i",{class:"fas fa-info-circle me-2"},null,-1)),s[14]||(s[14]=t("strong",null,"Simplifiez vos paiements !",-1)),s[15]||(s[15]=c(" Configurez un prélèvement automatique SEPA. ",-1)),t("a",{href:r.route("client.sepa"),class:"alert-link"},"Configurer maintenant",8,ft),s[16]||(s[16]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert"},null,-1))])),t("div",bt,[t("div",ht,[t("div",_t,[s[17]||(s[17]=t("div",{class:"card-header py-3"},[t("h6",{class:"m-0 font-weight-bold text-primary"},[t("i",{class:"fas fa-chart-pie me-2"}),c(" Répartition des Factures ")])],-1)),t("div",yt,[t("canvas",gt,null,512)])])]),t("div",vt,[t("div",pt,[s[18]||(s[18]=t("div",{class:"card-header py-3"},[t("h6",{class:"m-0 font-weight-bold text-primary"},[t("i",{class:"fas fa-chart-bar me-2"}),c(" Évolution des Paiements (6 derniers mois) ")])],-1)),t("div",xt,[t("canvas",wt,null,512)])])])]),a.contratsActifs&&a.contratsActifs.length>0?(i(),d("div",Ct,[s[21]||(s[21]=t("div",{class:"card-header py-3"},[t("h6",{class:"m-0 font-weight-bold text-primary"},[t("i",{class:"fas fa-file-contract me-2"}),c(" Mes Contrats Actifs ")])],-1)),t("div",At,[t("div",kt,[t("table",Dt,[s[20]||(s[20]=t("thead",null,[t("tr",null,[t("th",null,"N° Contrat"),t("th",null,"Box"),t("th",null,"Date Début"),t("th",null,"Loyer Mensuel"),t("th",null,"Actions")])],-1)),t("tbody",null,[(i(!0),d(x,null,w(a.contratsActifs,e=>(i(),d("tr",{key:e.id},[t("td",null,[t("strong",null,n(e.numero_contrat),1)]),t("td",null,[e.box?(i(),d("span",Ft,[c(" Box "+n(e.box.numero)+" ",1),e.box.famille?(i(),d("span",{key:0,class:"badge ms-1",style:B({backgroundColor:e.box.famille.couleur||"#6c757d"})},n(e.box.famille.nom),5)):f("",!0)])):f("",!0)]),t("td",null,n(l.formatDate(e.date_debut)),1),t("td",null,[t("strong",St,n(l.formatAmount(e.montant_loyer))+" €",1)]),t("td",null,[t("a",{href:r.route("client.contrats.show",e.id),class:"btn btn-sm btn-outline-primary"},[...s[19]||(s[19]=[t("i",{class:"fas fa-eye"},null,-1)])],8,Bt)])]))),128))])])]),t("div",Lt,[t("a",{href:r.route("client.contrats"),class:"btn btn-primary"}," Voir tous mes contrats ",8,Mt)])])])):f("",!0),a.dernieresFactures&&a.dernieresFactures.length>0?(i(),d("div",Et,[s[24]||(s[24]=t("div",{class:"card-header py-3"},[t("h6",{class:"m-0 font-weight-bold text-primary"},[t("i",{class:"fas fa-file-invoice me-2"}),c(" Dernières Factures ")])],-1)),t("div",Nt,[t("div",Rt,[t("table",Vt,[s[23]||(s[23]=t("thead",null,[t("tr",null,[t("th",null,"N° Facture"),t("th",null,"Date Émission"),t("th",null,"Date Échéance"),t("th",{class:"text-end"},"Montant TTC"),t("th",null,"Statut"),t("th",null,"Actions")])],-1)),t("tbody",null,[(i(!0),d(x,null,w(a.dernieresFactures,e=>(i(),d("tr",{key:e.id},[t("td",null,[t("strong",null,n(e.numero_facture),1)]),t("td",null,n(l.formatDate(e.date_emission)),1),t("td",null,n(l.formatDate(e.date_echeance)),1),t("td",Pt,[t("strong",null,n(l.formatAmount(e.montant_ttc))+" €",1)]),t("td",null,[t("span",{class:p(l.getStatusBadge(e.statut))},n(l.getStatusLabel(e.statut)),3)]),t("td",null,[t("a",{href:r.route("client.factures.show",e.id),class:"btn btn-sm btn-outline-primary"},[...s[22]||(s[22]=[t("i",{class:"fas fa-eye"},null,-1)])],8,zt)])]))),128))])])]),t("div",It,[t("a",{href:r.route("client.factures"),class:"btn btn-primary"}," Voir toutes mes factures ",8,Tt)])])])):f("",!0)]),_:1})}const Gt=R(V,[["render",jt],["__scopeId","data-v-d95cd81b"]]);export{Gt as default};
