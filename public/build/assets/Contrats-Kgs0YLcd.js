import{C as x}from"./ClientLayout-8AzT50KU.js";import{r as C,f as D,w as k,a as t,g as f,h as g,l as w,v as _,d as m,c as d,i as y,o as u,F as b,j as p,t as o,m as S,n as c,x as h}from"./app-D3-luHWI.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css            */const A={components:{ClientLayout:x},props:{contrats:{type:Object,required:!0},queryParams:{type:Object,default:()=>({})}},data(){return{filters:{search:this.queryParams.search||"",statut:this.queryParams.statut||"",sort_by:this.queryParams.sort_by||"created_at",sort_order:this.queryParams.sort_order||"desc"}}},computed:{paginationPages(){const a=[],e=this.contrats.current_page,r=this.contrats.last_page;let i=Math.max(1,e-2),l=Math.min(r,e+2);l-i<4&&(i===1?l=Math.min(5,r):l===r&&(i=Math.max(1,r-4)));for(let n=i;n<=l;n++)a.push(n);return a}},methods:{applyFilters(){h.get(route("client.contrats"),this.filters,{preserveState:!0,preserveScroll:!0})},changePage(a){a<1||a>this.contrats.last_page||h.get(route("client.contrats"),{...this.filters,page:a},{preserveState:!0,preserveScroll:!0})},formatDate(a){return a?new Date(a).toLocaleDateString("fr-FR"):""},timeAgo(a){if(!a)return"";const e=new Date(a),i=Math.abs(new Date-e),l=Math.ceil(i/(1e3*60*60*24));if(l<30)return`Il y a ${l} jour${l>1?"s":""}`;if(l<365)return`Il y a ${Math.floor(l/30)} mois`;{const n=Math.floor(l/365);return`Il y a ${n} an${n>1?"s":""}`}},getDaysRemainingText(a){if(!a)return"";const i=new Date(a)-new Date,l=Math.ceil(i/(1e3*60*60*24));return l>0?`${l} jour${l>1?"s":""}`:l===0?"Aujourd'hui":"Expiré"},getDaysRemainingClass(a){if(!a)return"";const i=new Date(a)-new Date,l=Math.ceil(i/(1e3*60*60*24));return l>0?"text-success":l===0?"text-warning":"text-danger"},formatAmount(a){return a?parseFloat(a).toFixed(2):"0.00"},getStatusBadgeClass(a){return{actif:"badge bg-success",en_cours:"badge bg-info",resilie:"badge bg-danger",termine:"badge bg-secondary"}[a]||"badge bg-warning"},getStatusIcon(a){return{actif:"fas fa-check-circle",en_cours:"fas fa-clock",resilie:"fas fa-times-circle",termine:"fas fa-flag-checkered"}[a]||"fas fa-question"},getStatusLabel(a){return{actif:"Actif",en_cours:"En cours",resilie:"Résilié",termine:"Terminé"}[a]||a.charAt(0).toUpperCase()+a.slice(1)}}},T={class:"card mb-4"},P={class:"card-body"},F={class:"col-md-4"},L={class:"col-md-3"},N={class:"col-md-3"},R={class:"card"},B={class:"card-body p-0"},j={class:"table-responsive"},q={class:"table table-hover align-middle mb-0"},I={class:"text-primary"},V={class:"badge bg-secondary"},E={class:"text-muted"},U={key:1,class:"text-muted"},z={class:"text-muted"},O={class:"text-muted"},G={key:1,class:"text-muted"},H={class:"text-end"},J={class:"text-primary"},K={class:"text-end"},Q={class:"btn-group btn-group-sm"},W=["href"],X=["href"],Y={key:0},Z={key:0,class:"card-footer bg-white"},$={class:"d-flex justify-content-between align-items-center"},tt={class:"text-muted small"},et={class:"pagination pagination-sm mb-0"},st=["onClick"];function at(a,e,r,i,l,n){const v=C("ClientLayout");return u(),D(v,{title:"Mes Contrats"},{default:k(()=>[e[20]||(e[20]=t("div",{class:"mb-4"},[t("h1",{class:"h3"},"Mes Contrats"),t("p",{class:"text-muted"},"Consultez l'ensemble de vos contrats de location")],-1)),t("div",T,[t("div",P,[t("form",{onSubmit:e[3]||(e[3]=f((...s)=>n.applyFilters&&n.applyFilters(...s),["prevent"])),class:"row g-3"},[t("div",F,[g(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>l.filters.search=s),class:"form-control",placeholder:"Rechercher par N° contrat ou box..."},null,512),[[w,l.filters.search]])]),t("div",L,[g(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>l.filters.statut=s),class:"form-select"},[...e[6]||(e[6]=[t("option",{value:""},"Tous les statuts",-1),t("option",{value:"actif"},"Actif",-1),t("option",{value:"en_cours"},"En cours",-1),t("option",{value:"resilie"},"Résilié",-1),t("option",{value:"termine"},"Terminé",-1)])],512),[[_,l.filters.statut]])]),t("div",N,[g(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>l.filters.sort_by=s),class:"form-select"},[...e[7]||(e[7]=[t("option",{value:"created_at"},"Date de création",-1),t("option",{value:"date_debut"},"Date d'entrée",-1),t("option",{value:"numero_contrat"},"N° contrat",-1),t("option",{value:"montant_loyer"},"Loyer",-1)])],512),[[_,l.filters.sort_by]])]),e[8]||(e[8]=t("div",{class:"col-md-2"},[t("button",{type:"submit",class:"btn btn-primary w-100"},[t("i",{class:"fas fa-search me-1"}),m("Rechercher ")])],-1))],32)])]),t("div",R,[t("div",B,[t("div",j,[t("table",q,[e[19]||(e[19]=t("thead",{class:"table-light"},[t("tr",null,[t("th",null,"N° Contrat"),t("th",null,"N° Box"),t("th",null,"Type/Famille"),t("th",null,"Date Entrée"),t("th",null,"Date Fin"),t("th",{class:"text-end"},"Loyer TTC"),t("th",{class:"text-end"},"Caution"),t("th",null,"État"),t("th",null,"Actions")])],-1)),t("tbody",null,[(u(!0),d(b,null,p(r.contrats.data,s=>(u(),d("tr",{key:s.id},[t("td",null,[t("strong",I,o(s.numero_contrat),1)]),t("td",null,[t("span",V,"Box "+o(s.box.numero),1),e[9]||(e[9]=t("br",null,null,-1)),t("small",E,o(s.box.surface)+" m²",1)]),t("td",null,[s.box.famille?(u(),d("span",{key:0,class:"badge",style:S({backgroundColor:s.box.famille.couleur||"#6c757d"})},o(s.box.famille.nom),5)):(u(),d("span",U,"N/A")),e[11]||(e[11]=t("br",null,null,-1)),t("small",z,[e[10]||(e[10]=t("i",{class:"fas fa-map-marker-alt"},null,-1)),m(" "+o(s.box.emplacement?.nom||"N/A"),1)])]),t("td",null,[m(o(n.formatDate(s.date_debut))+" ",1),e[12]||(e[12]=t("br",null,null,-1)),t("small",O,o(n.timeAgo(s.date_debut)),1)]),t("td",null,[s.date_fin?(u(),d(b,{key:0},[m(o(n.formatDate(s.date_fin))+" ",1),e[13]||(e[13]=t("br",null,null,-1)),t("small",{class:c(n.getDaysRemainingClass(s.date_fin))},o(n.getDaysRemainingText(s.date_fin)),3)],64)):(u(),d("span",G,"Indéterminée"))]),t("td",H,[t("strong",J,o(n.formatAmount(s.montant_loyer))+" €",1),e[14]||(e[14]=t("br",null,null,-1)),e[15]||(e[15]=t("small",{class:"text-muted"},"/mois",-1))]),t("td",K,o(n.formatAmount(s.depot_garantie))+" € ",1),t("td",null,[t("span",{class:c(n.getStatusBadgeClass(s.statut))},[t("i",{class:c([n.getStatusIcon(s.statut),"me-1"])},null,2),m(" "+o(n.getStatusLabel(s.statut)),1)],2)]),t("td",null,[t("div",Q,[t("a",{href:a.route("client.contrats.show",s.id),class:"btn btn-outline-primary",title:"Voir les détails"},[...e[16]||(e[16]=[t("i",{class:"fas fa-eye"},null,-1)])],8,W),t("a",{href:a.route("client.contrats.pdf",s.id),class:"btn btn-outline-secondary",title:"Télécharger PDF"},[...e[17]||(e[17]=[t("i",{class:"fas fa-file-pdf"},null,-1)])],8,X)])])]))),128)),!r.contrats.data||r.contrats.data.length===0?(u(),d("tr",Y,[...e[18]||(e[18]=[t("td",{colspan:"9",class:"text-center py-5"},[t("i",{class:"fas fa-inbox fa-3x text-muted mb-3 d-block"}),t("p",{class:"text-muted mb-0"},"Aucun contrat trouvé")],-1)])])):y("",!0)])])])]),r.contrats.last_page>1?(u(),d("div",Z,[t("div",$,[t("div",tt," Affichage de "+o(r.contrats.from)+" à "+o(r.contrats.to)+" sur "+o(r.contrats.total)+" contrats ",1),t("nav",null,[t("ul",et,[t("li",{class:c(["page-item",{disabled:!r.contrats.prev_page_url}])},[t("a",{class:"page-link",onClick:e[4]||(e[4]=f(s=>n.changePage(r.contrats.current_page-1),["prevent"]))}," Précédent ")],2),(u(!0),d(b,null,p(n.paginationPages,s=>(u(),d("li",{key:s,class:c(["page-item",{active:s===r.contrats.current_page}])},[t("a",{class:"page-link",onClick:f(lt=>n.changePage(s),["prevent"])},o(s),9,st)],2))),128)),t("li",{class:c(["page-item",{disabled:!r.contrats.next_page_url}])},[t("a",{class:"page-link",onClick:e[5]||(e[5]=f(s=>n.changePage(r.contrats.current_page+1),["prevent"]))}," Suivant ")],2)])])])])):y("",!0)])]),_:1})}const ut=M(A,[["render",at],["__scopeId","data-v-610fa983"]]);export{ut as default};
