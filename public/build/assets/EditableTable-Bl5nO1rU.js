import{q as k,E as M,c as a,o as n,a as l,i as _,F as v,j as m,n as p,t as f,h,M as R,l as x,v as V,K as D,g as E,x as S}from"./app-zGlaTtug.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";const T={props:{data:{type:Array,required:!0},columns:{type:Array,required:!0},editable:{type:Boolean,default:!1},deletable:{type:Boolean,default:!1},updateRoute:{type:String,default:null},emptyMessage:{type:String,default:null},pagination:{type:Object,default:null}},emits:["update","delete","page-change"],setup(g,{emit:i}){const s=k([...g.data]),e=k(null),y=k({}),b=k(!1);return M(()=>g.data,d=>{s.value=[...d]}),{localData:s,editingRow:e,editForm:y,saving:b,formatCell:(d,u)=>{const c=d[u.key];if(u.format)return u.format(c,d);if(u.type==="date"&&c)return new Date(c).toLocaleDateString("fr-FR");if(u.type==="number"&&c!==null&&c!==void 0)return parseFloat(c).toFixed(2);if(u.type==="currency"&&c!==null&&c!==void 0)return parseFloat(c).toFixed(2)+" €";if(u.type==="badge"&&u.badges){const C=u.badges[c];if(C)return`<span class="badge ${C.class}">${C.label}</span>`}return c||"-"},startEdit:d=>{e.value=d.id,y.value={...d}},cancelEdit:()=>{e.value=null,y.value={}},saveRow:async d=>{b.value=!0,g.updateRoute?S.put(g.updateRoute.replace(":id",d.id),y.value,{preserveScroll:!0,onSuccess:()=>{e.value=null,y.value={},b.value=!1},onError:()=>{b.value=!1}}):(i("update",{id:d.id,data:y.value}),e.value=null,y.value={},b.value=!1)},changePage:d=>{d>=1&&d<=g.pagination.last_page&&i("page-change",d)}}}},L={class:"editable-table"},A={class:"table-responsive"},B={class:"table table-hover"},P={key:0},H=["onUpdate:modelValue","type"],j=["onUpdate:modelValue"],q=["onUpdate:modelValue"],w=["onUpdate:modelValue"],N=["value"],z=["innerHTML"],I=["innerHTML"],K={key:0},O={key:0,class:"btn-group btn-group-sm"},G=["onClick","disabled"],J=["disabled"],Q={key:1,class:"btn-group btn-group-sm"},W=["onClick"],X=["onClick"],Y={key:0},Z=["colspan"],$={key:0,class:"d-flex justify-content-between align-items-center mt-3"},ee={class:"text-muted"},te={class:"pagination pagination-sm mb-0"},ae={class:"page-item active"},ne={class:"page-link"};function le(g,i,s,e,y,b){return n(),a("div",L,[l("div",A,[l("table",B,[l("thead",null,[l("tr",null,[(n(!0),a(v,null,m(s.columns,o=>(n(),a("th",{key:o.key,class:p(o.headerClass)},f(o.label),3))),128)),s.editable?(n(),a("th",P,"Actions")):_("",!0)])]),l("tbody",null,[(n(!0),a(v,null,m(e.localData,(o,F)=>(n(),a("tr",{key:o.id||F},[(n(!0),a(v,null,m(s.columns,t=>(n(),a("td",{key:t.key,class:p(t.cellClass)},[e.editingRow===o.id?(n(),a(v,{key:0},[t.type==="text"||!t.type?h((n(),a("input",{key:0,"onUpdate:modelValue":r=>e.editForm[t.key]=r,class:"form-control form-control-sm",type:t.inputType||"text"},null,8,H)),[[R,e.editForm[t.key]]]):t.type==="number"?h((n(),a("input",{key:1,"onUpdate:modelValue":r=>e.editForm[t.key]=r,class:"form-control form-control-sm",type:"number",step:"0.01"},null,8,j)),[[x,e.editForm[t.key]]]):t.type==="date"?h((n(),a("input",{key:2,"onUpdate:modelValue":r=>e.editForm[t.key]=r,class:"form-control form-control-sm",type:"date"},null,8,q)),[[x,e.editForm[t.key]]]):t.type==="select"?h((n(),a("select",{key:3,"onUpdate:modelValue":r=>e.editForm[t.key]=r,class:"form-select form-select-sm"},[(n(!0),a(v,null,m(t.options,r=>(n(),a("option",{key:r.value,value:r.value},f(r.label),9,N))),128))],8,w)),[[V,e.editForm[t.key]]]):(n(),a("span",{key:4,innerHTML:e.formatCell(o,t)},null,8,z))],64)):(n(),a("span",{key:1,innerHTML:e.formatCell(o,t)},null,8,I))],2))),128)),s.editable?(n(),a("td",K,[e.editingRow===o.id?(n(),a("div",O,[l("button",{onClick:t=>e.saveRow(o),class:"btn btn-success",disabled:e.saving},[...i[3]||(i[3]=[l("i",{class:"fas fa-check"},null,-1)])],8,G),l("button",{onClick:i[0]||(i[0]=(...t)=>e.cancelEdit&&e.cancelEdit(...t)),class:"btn btn-secondary",disabled:e.saving},[...i[4]||(i[4]=[l("i",{class:"fas fa-times"},null,-1)])],8,J)])):(n(),a("div",Q,[l("button",{onClick:t=>e.startEdit(o),class:"btn btn-outline-primary"},[...i[5]||(i[5]=[l("i",{class:"fas fa-edit"},null,-1)])],8,W),s.deletable?(n(),a("button",{key:0,onClick:t=>g.$emit("delete",o),class:"btn btn-outline-danger"},[...i[6]||(i[6]=[l("i",{class:"fas fa-trash"},null,-1)])],8,X)):_("",!0),D(g.$slots,"row-actions",{row:o},void 0,!0)]))])):_("",!0)]))),128)),!e.localData||e.localData.length===0?(n(),a("tr",Y,[l("td",{colspan:s.columns.length+(s.editable?1:0),class:"text-center text-muted"},f(s.emptyMessage||"Aucune donnée disponible"),9,Z)])):_("",!0)])])]),s.pagination?(n(),a("div",$,[l("div",ee," Affichage "+f(s.pagination.from)+" à "+f(s.pagination.to)+" sur "+f(s.pagination.total)+" résultats ",1),l("nav",null,[l("ul",te,[l("li",{class:p(["page-item",{disabled:!s.pagination.prev_page_url}])},[l("a",{class:"page-link",href:"#",onClick:i[1]||(i[1]=E(o=>e.changePage(s.pagination.current_page-1),["prevent"]))}," Précédent ")],2),l("li",ae,[l("span",ne,f(s.pagination.current_page),1)]),l("li",{class:p(["page-item",{disabled:!s.pagination.next_page_url}])},[l("a",{class:"page-link",href:"#",onClick:i[2]||(i[2]=E(o=>e.changePage(s.pagination.current_page+1),["prevent"]))}," Suivant ")],2)])])])):_("",!0)])}const de=U(T,[["render",le],["__scopeId","data-v-896b6468"]]);export{de as E};
