import{r as B,f as D,o as i,w as V,a as t,c as l,i as u,d as f,n as d,t as c,F as A,j as M,g as L,q as h,u as x,x as R}from"./app-zGlaTtug.js";import{C as F}from"./ClientLayout-DE-sKSWk.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css            */const z={components:{ClientLayout:F},props:{notifications:{type:Array,default:()=>[]}},setup(m){const o=h("all"),b=h("all"),e=h(!1),g={all:"Toutes",facture:"Factures",paiement:"Paiements",relance:"Relances",contrat:"Contrats",document:"Documents",systeme:"Système",message:"Messages"},_=x(()=>m.notifications.filter(s=>!s.lu).length),p=x(()=>_.value>0),n=x(()=>{let s=m.notifications;return o.value==="unread"&&(s=s.filter(a=>!a.lu)),b.value!=="all"&&(s=s.filter(a=>a.type===b.value)),s}),r=s=>({facture:"fa-file-invoice text-primary",paiement:"fa-credit-card text-success",relance:"fa-exclamation-circle text-warning",contrat:"fa-file-contract text-info",document:"fa-file-alt text-secondary",systeme:"fa-cog text-dark",message:"fa-envelope text-primary"})[s]||"fa-bell text-secondary",C=s=>({all:"fa-list",facture:"fa-file-invoice",paiement:"fa-credit-card",relance:"fa-exclamation-circle",contrat:"fa-file-contract",document:"fa-file-alt",systeme:"fa-cog",message:"fa-envelope"})[s]||"fa-bell",I=s=>({facture:"bg-primary",paiement:"bg-success",relance:"bg-warning",contrat:"bg-info",document:"bg-secondary",systeme:"bg-dark",message:"bg-primary"})[s]||"bg-secondary",S=s=>g[s]||"Notification",j=s=>{const a=new Date(s),v=new Date-a,k=Math.floor(v/6e4),N=Math.floor(v/36e5),y=Math.floor(v/864e5);return k<1?"À l'instant":k<60?`Il y a ${k} min`:N<24?`Il y a ${N}h`:y<7?`Il y a ${y}j`:y<30?`Il y a ${Math.floor(y/7)} semaine(s)`:a.toLocaleDateString("fr-FR")},T=s=>{R.post(route("client.notifications.mark-read",s),{},{preserveScroll:!0,onSuccess:()=>{const a=m.notifications.find(w=>w.id===s);a&&(a.lu=!0)}})};return{filterType:o,filterCategory:b,marking:e,notificationTypes:g,unreadCount:_,hasUnread:p,filteredNotifications:n,getNotificationIcon:r,getTypeIcon:C,getTypeBadge:I,getTypeLabel:S,formatRelativeTime:j,markAsRead:T,markAllAsRead:()=>{e.value=!0,R.post(route("client.notifications.mark-all-read"),{},{preserveScroll:!0,onFinish:()=>{e.value=!1},onSuccess:()=>{m.notifications.forEach(s=>{s.lu=!0})}})},handleNotificationClick:s=>{s.lu||T(s.id)},goToLink:s=>{window.location.href=s}}}},E={class:"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom"},U={class:"btn-toolbar mb-2 mb-md-0"},H=["disabled"],P={class:"btn-group btn-group-sm"},G={class:"mb-4"},J={class:"btn-group btn-group-sm",role:"group"},K=["onClick"],O={key:0,class:"row"},Q={class:"col-12"},W={class:"notifications-list"},X=["onClick"],Y={class:"card-body p-3"},Z={class:"d-flex align-items-start"},$={class:"notification-icon me-3"},tt={class:"flex-grow-1"},et={class:"d-flex justify-content-between align-items-start mb-2"},st={class:"mb-0 notification-title"},nt={key:0,class:"badge bg-primary ms-2"},ot={class:"text-muted"},at={class:"mb-2 text-muted notification-message"},it={class:"d-flex justify-content-between align-items-center"},lt=["onClick"],rt=["onClick"],ct={key:1,class:"text-center py-5"},dt={class:"text-muted"},ft={key:2,class:"d-flex justify-content-center mt-4"},mt={class:"pagination"},ut={class:"page-item disabled"},bt={class:"page-link"};function yt(m,o,b,e,g,_){const p=B("ClientLayout");return i(),D(p,{title:"Mes Notifications"},{default:V(()=>[t("div",E,[o[4]||(o[4]=t("h1",{class:"h3"},[t("i",{class:"fas fa-bell me-2"}),f(" Mes Notifications ")],-1)),t("div",U,[e.hasUnread?(i(),l("button",{key:0,onClick:o[0]||(o[0]=(...n)=>e.markAllAsRead&&e.markAllAsRead(...n)),class:"btn btn-sm btn-outline-primary me-2",disabled:e.marking},[...o[3]||(o[3]=[t("i",{class:"fas fa-check-double me-1"},null,-1),f(" Tout marquer comme lu ",-1)])],8,H)):u("",!0),t("div",P,[t("button",{onClick:o[1]||(o[1]=n=>e.filterType="all"),class:d(["btn",e.filterType==="all"?"btn-primary":"btn-outline-secondary"])}," Toutes ",2),t("button",{onClick:o[2]||(o[2]=n=>e.filterType="unread"),class:d(["btn",e.filterType==="unread"?"btn-primary":"btn-outline-secondary"])}," Non lues ("+c(e.unreadCount)+") ",3)])])]),t("div",G,[t("div",J,[(i(!0),l(A,null,M(e.notificationTypes,(n,r)=>(i(),l("button",{key:r,onClick:C=>e.filterCategory=r,type:"button",class:d(["btn",e.filterCategory===r?"btn-primary":"btn-outline-secondary"])},[t("i",{class:d(["fas",e.getTypeIcon(r)])},null,2),f(" "+c(n),1)],10,K))),128))])]),e.filteredNotifications.length>0?(i(),l("div",O,[t("div",Q,[t("div",W,[(i(!0),l(A,null,M(e.filteredNotifications,n=>(i(),l("div",{key:n.id,class:d(["notification-card card mb-3 shadow-sm",{"notification-unread":!n.lu}]),onClick:r=>e.handleNotificationClick(n)},[t("div",Y,[t("div",Z,[t("div",$,[t("i",{class:d(["fas fa-2x",e.getNotificationIcon(n.type)])},null,2)]),t("div",tt,[t("div",et,[t("h6",st,[f(c(n.titre)+" ",1),n.lu?u("",!0):(i(),l("span",nt,"Nouveau"))]),t("small",ot,c(e.formatRelativeTime(n.created_at)),1)]),t("p",at,c(n.message),1),t("div",it,[t("span",{class:d(["badge",e.getTypeBadge(n.type)])},c(e.getTypeLabel(n.type)),3),t("div",null,[n.lu?u("",!0):(i(),l("button",{key:0,onClick:L(r=>e.markAsRead(n.id),["stop"]),class:"btn btn-sm btn-outline-primary me-2"},[...o[5]||(o[5]=[t("i",{class:"fas fa-check"},null,-1),f(" Marquer comme lu ",-1)])],8,lt)),n.lien?(i(),l("button",{key:1,onClick:L(r=>e.goToLink(n.lien),["stop"]),class:"btn btn-sm btn-primary"},[...o[6]||(o[6]=[t("i",{class:"fas fa-arrow-right"},null,-1),f(" Voir ",-1)])],8,rt)):u("",!0)])])])])])],10,X))),128))])])])):(i(),l("div",ct,[o[7]||(o[7]=t("i",{class:"fas fa-inbox fa-4x text-muted mb-3"},null,-1)),o[8]||(o[8]=t("h4",{class:"text-muted"},"Aucune notification",-1)),t("p",dt,c(e.filterType==="unread"?"Vous n'avez pas de nouvelles notifications":"Votre boîte de notifications est vide"),1)])),e.filteredNotifications.length>0?(i(),l("div",ft,[t("nav",null,[t("ul",mt,[t("li",ut,[t("span",bt,c(e.filteredNotifications.length)+" notification(s)",1)])])])])):u("",!0)]),_:1})}const Ct=q(z,[["render",yt],["__scopeId","data-v-3835b8b3"]]);export{Ct as default};
